## SECTION 2 _ 스프링 핵심 원리 이해1 - 예제 만들기 
    
    c.f. 설정 용이하기 위해 스프링 부트 이용 but 이번 챕터는 순수 자바 코드로만 진행될 예정
    

### 프로젝트 생성

- java 11 설치(기존)
- 스프링 부트
        https://start.spring.io/spring.io.starter 에서 gradle, java, 2.3.3(snapshot없는 최신버전), 11, jar dependencies 추가 없이 생성 -> 압축해제 -> 임포트
            *** 강의와 별도로 build.gradle에 이클립스 관련 설정 추가함


### 비즈니스 요구사항과 설계(pdf 참고)

- 회원
        회원을 가입하고 조회할 수 있다.
        회원은 일반과 VIP 두 가지 등급이 있다.
        회원 데이터는 자체 DB를 구축할 수 있고, 외부 시스템과 연동할 수 있다. (미확정)

- 주문과 할인 정책
        회원은 상품을 주문할 수 있다.
        회원 등급에 따라 할인 정책을 적용할 수 있다.
        할인 정책은 모든 VIP는 1000원을 할인해주는 고정 금액 할인을 적용해달라. (나중에 변경 될 수 있다.)
        할인 정책은 변경 가능성이 높다. 회사의 기본 할인 정책을 아직 정하지 못했고, 오픈 직전까지 고민을 미루고 싶다. 최악의 경우 할인을 적용하지 않을 수 도 있다. (미확정)

    *** 요구사항을 보면 회원 데이터, 할인 정책 같은 부분은 지금 결정하기 어려운 부분이다. 그렇다고 이런 정책이 결정될 때 까지 개발을 무기한 기다릴 수 도 없다. 우리는 앞에서 배운 객체 지향 설계 방법을 이용할 것


### 회원 도메인 설계(pdf 참고)

- 보통 아래 3개의 그림을 기반으로 설계 시작

     - 회원 도메인 협력관계: 기획자 & 개발자가 함께 보는 자료, 이를 기반으로 개발자가 아래 두 개의 다이어그램으로 구체화
    - 회원 클래스 다이어그램: 실제 서버를 실행하지 않고 클래스만 분석해서 볼 수 있는 그림
    - 회원 객체 다이어그램: 서버가 실행될 때 결정, 클래스가 실제로 사용하는 클래스 결정
        ex. 회원 서비스 == MemberServiceImpl


### 회원 도메인 개발

- main > member 패키지 생성, 하위에 아래 객체들 생성
    - 회원 엔티티: Member 클래스, Grade 이넘클래스 생성
    - 회원 저장소: MemberRepository 인터페이스 생성, 구현체 MemoryMemberRepository 클래스 생성 
                *** HashMap 은 동시성 이슈가 발생할 수 있다. 이런 경우 ConcurrentHashMap 을 사용
    - 회원 서비스: MemberService 인터페이스 생성, 구현체 MemberServiceImpl 클래스 생성

    *** 요구사항 및 도메인 설계와 비교하며 객체 구조 이해하면 좋을 듯


### 회원 도메인 실행과 테스트

- 애플리케이션 로직 테스트
    - member 패키지 하위에 회원 도메인 (MemberApp) 생성 but 좋은 방법이 아님 -> 대안: JUnit 테스트를 사용할 것

- JUnit 테스트
        - test > member 패키지 생성, 하위에 테스트용 memberApp 클래스 생성 & 테스트

    *** 회원 도메인 설계 문제점: 의존관계가 인터페이스뿐만 아니라 구현까지 모두 의존함
        -> 주문 도메인까지 개발 후에 문제점, 해결방안 설명 예정


### 주문과 할인 도메인 설계(pdf 참고)

- 회원 도메인과 설명 동일
- 주문 도메인 전체, 주문 도메인 클래스 다이어그램, 주문 도메인 객체 다이어그램으로 나누어서 설계
     *** 설계의 핵심은 아직 정해지거나 구체화되지 않은 조건도 객체지향적인 생각을 배경으로 틀을 만들어 놓을 수 있어야 한다는 것


### 주문과 할인 도메인 개발

- main > discount 패키지 생성, 하위에 아래 객체들 생성
    - 할인 정책 인터페이스 DiscountPolicy & 정액 할인 정책 구현체 FixDiscountPolicy 생성

- main > order 패키지 생성, 하위에 아래 객체들 생성
    - 주문 엔티티: Order 클래스 생성
    - 주문 서비스 인터페이스 OrderService & 주문 서비스 구현체 OrderServiceImpl 생성
        -> 주문 생성 요청이 오면, 회원 정보를 조회하고, 할인 정책을 적용한 다음 주문 객체를 생성해서 반환한다. 
            메모리 회원 리포지토리와, 고정 금액 할인 정책을 구현체로 생성한다.


### 주문과 할인 도메인 실행과 테스트

- 회원과 동일하게 애플리케이션 로직 테스트, JUnit 테스트 사용
