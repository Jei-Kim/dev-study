# Chapter 09. 웹 브라우저

- 웹 브라우저는 가상머신의 일종
- 웹 브라우저의 개발자 콘솔을 통해 브라우저의 작동 방식 알아보기


## 마크업 언어


- 정의: 본문과 구분되는 마크(=애노테이션)를 추가할 수 있는 시스템
    - ex. troff, IBM의 GML, SGML, XML

- IBM의 GML을 확장한 SGML이 만들어짐 -> ISO에서 표준으로 채택

- XML은 확장 가능한 마크업 언어를 뜻하며, SGML의 하위 집합임
    - 브라우저들은 나중에 xml을 지원하게 됨

- HTML 역시 SGML을 뿌리로 하되, 표준을 준수하지는 않음

- XHTML은 HTML을 변형한 형태로, XML 규칙을 준수함



## 균일 자원 위치 지정자


- 균일 자원 위치 지정자 == URL(Uniform Resource Locator)
    - 최초의 웹 브라우저(world wide web)에서는 url 사용해 http프로토콜을 통해 서버에게 문서를 요청
        - 서버: 문서를 브라우저에 보냄 / 브라우저: 문서를 표시함
    - 당시에 사용된 문서는 html로 작성되었으며, 현재는 다양한 언어로 문서 작성 가능

* URL 구조

    - 세 가지로 나뉨 ==> 스킴, 호스트, 경로
        - 스킴: 통신 메커니즘(ex. http)
        - 호스트: 숫자로 된 인터넷 주소 or 도메인 이름(ex. www.00.com)
        - 경로: 문서가 추출될 위치(ex. catalog/general)

    - 참고) 스킴 중 file을 사용하면 컴퓨터에 있는 파일을 가리킬 수 있음



## HTML 문서


- 하이퍼텍스트 활용
    - 웹 페이지 등 다른 대상에 대한 링크가 들어 있는 텍스트

- 부등호 사용 -> 마크업 엘리먼트 시작(ex. <tag>)
    - 태그는 브라우저가 마크업 엘리먼트를 어떻게 해석할 지 결정(ex. title, b, body)

* 엔티티 참조
    : 문자를 다른 문자열로 표현하는 방법

    - '&lt;' 라는 문자 시퀀스를 사용해 '<'를 글자 그대로 표현할 수 있음

- 끝 태그를 쓰지 않아도 되는 경우가 있으나, 규칙적인 예외가 아님
- 엘리먼트 안에 내용이 없을 경우, '<tag/>'처럼 시작~끝 태크를 한 번에 쓰기도 함

* 애트리뷰트가 있는 앨리먼트
    : 이름과 값을 =로 연결한 쌍
    - ex) name="value"
    - 이름에 따라 미리 정의된 동작이 있는 애트리뷰트 존재, 이 외에는 아무 이름이나 사용 가능



## DOM: 문서 객체 모델


- 웹 브라우저는 문서를 문서 객체 모델에 따라 처리함
    - 들여쓰기를 통해 알 수 있듯이, 어떤 엘리먼트가 다른 엘리먼트들을 감싸고 있는 구조
        - DAG, 트리 구조와 같음

* 트리 관련 용어 & 예시

    - 노드: 트리를 이루는 엘리먼트들
        - html, head, body

    - 내부 노드: 나가는 화살표가 존재하는 노드
        - title

    - 종단 노드: 나가는 화살표가 없는 노드(leaf, termainal)
        - Cool!

    - 루트: 최상위 노드
        - html

    - 부모: 화살표의 출발점에 있는 노드
        - html

    - 자식: 화살표의 머리 부분에 있는 노드
        - head, body

    - 후손 또는 자손(descendant): 직간접적으로 다른 노드의 자식이거나, 자식의 자식 등의 관계가 있는 노드
        - title은 html의 자손 노드

    - 선조 또는 조상(ancestor): 직간접적으로 다른 노드의 부모거나, 부모의 부모 등의 관계가 있는 노드
        - body는 big의 선조

    - 형제 또는 자매: 한 부모의 자식인 노드 간의 관계
        - head는 body의 자매

- 트리에 있는 노드는 순서가 정해져 있음
    - head는 첫 번째, body는 마지막 자손


* DOM 처리

- 브라우저는 깊이 우선 순회로 문서 트리를 해석함
    - html -> head -> title -> title 내용 -> 다시 body -> body내용 이런 식으로 탐색



## CSS


 - Cascating Style Sheet
    - html에서 스타일 정보 분리 -> html을 한 번만 작성해도 대상 장치에 따라 여러 스타일을 적용할 수 있음

* html 엘리먼트 데이터 구조
    - 애트리뷰트는 단일 연결 리스트로 구성
    - 엘리먼트들은 트리로 배열
        - 자식들은 순서가 중요해서 이중 연결 리스트로 다루어짐

- css는 셀렉터라는 정규식의 변형을 사용해 DOM의 앨리먼트 위치 지정
    - -> 구성요소를 어떻게 구성하느냐가 중요함
    - css가 선택된 앨리먼트와 애트리뷰트 연결해 줌



## XML 등의 마크업 언어


- XML은 SGML과 마찬가지로 잘 만들어진 엘리먼트를 요구
    - -> <tag>로 열었으면 반드시 </tag>로 닫아야 함

- html은 웹 페이지 응용이 목적이지만, xml은 다양한 응용 분야가 있음

- 대부분의 xml 태그는 정해진 의미가 없음 -> 원하는대로 태그에 의미를 부여할 수 있음
    - -> 정의와 확장이 자유롭기 때문에 동일한 이름의 태그가 존재할 위험이 있음 -> 엘리먼트 태그 앞에 접두사를 붙이는 매커니즘(namespace) 사용
        - ex. <xml xmlns:vml = "http://www.~~~>

- xml문서로부터 파스 트리를 만들어주는 라이브러리 존재
    - ex. DTD

- XML 경로 언어(XPath)
    - xml 문서에 대한 셀렉터 제공
    - 호환 불가능한 문법 사용
    - xpath 자체는 유용하지 않으나, 확장 가능한 스타일시트 언어 변환(XSLT)의 중요한 일종임
        - -> 임의의 데이터가 들어 있는 마크업을 브라우저에 표현하기 위해 html로 변환해야 할 경우에 사용

- XSLT + XPath 결합시 xml문서를 표현한 파스 트리 검색 및 변형으로 xml 문서의 일부분을 다른 형태로 변환하는 문서 조각을 작성할 수 있음


   
## 자바스크립트


- 동적인 웹 페이지 구현을 위해 등장
- 에크마 인터내셔널에 의해 ECMA-262로 표준화 됨 -> 에크마스크립트 혹은 EC로 불리기도 함
- 서버가 아닌 실제 프로그램을 웹 페이지에 포함시킬 수 있음 -> 이 프로그램은 DOM을 변경하고 직접 웹 서버와 통신할 수 있음

- 자바스크립트와 서버의 상호작용은 비동기 자바스크립트와 XML(=AJAX)를 통해 이루어짐
    - 비동기: 서버의 응답이 언제 일어날지에 대해 아무 제어를 하지 않음을 의미

- 서버와 자바스크립트를 오가는 데이터 형식은 xml을 사용했음

- DOM을 조작하는 함수 다수 존재
    - 트리 안의 노드를 재배치하거나, 엘리먼트를 추가/제거하는 등의 기능을 함



## jQuery


- DOM 함수 동작이 브라우저마다 다를 수 있음 + 함수 사용 불편 -> 제이쿼리 등장
- 제이쿼리 라이브러리는 셀렉터와 액션 조합

- ex. 클릭 시 실행될 이벤트 핸들러 예제



## SVG


- 크기 변경이 가능한 벡터 그래픽스
    - 그래픽과 텍스트를 만들 수 있도록 지원

* 포스트스크립트
    - 이식성(portability)에 문제가 있었음 -> 이식 가능한 문서 형식(portable document format;PDF) 등장 


## HTML5


- html의 최신 구현
    - header, footer, section등의 시맨틱 엘리먼트 추가됨 -> 문서 구조에 일관성 o
    - 캔버스 추가됨
    - audio, video 추가됨

    * 캔버스
        - SVG와 비슷한 기능을 다른 방식으로 제공    
        - DOM함수를 사용하는 SVG와 다르게, 캔버스를 위해 만들어진 새로운 자바스크립트 함수를 통해 조작


## JSON


- 과거 AJAX에서 브라우저 자바스크립트 프로그램이 서버에게 xml 형식 데이터를 전송했으나, 현재는 json으로 다룸

- Javascript Object Notation
    - JSON은 근본적으로 자바스크립트 객체를 사람이 읽기 쉬운 방식으로 표현한 것

- 자바스크립트의 eval 함수 -> 데이터인 json을 자바스크립트 프로그램인것처럼 실행할 수 있음
    - 공격자가 원하는 코드를 브라우저에서 실행할 수 있는 위험 존재 -> 최근에는 JSON.parse 함수 사용



## 정리


- 인터프리터 동작 구조에 대한 지식으로, 소프트웨어 설계를 넘어 하드웨어 설계 시 고려할 점을 생각해 볼 수 있음
    - 웹 프로그래밍이 아닌 시스템 수준의 프로그래밍을 한다면 이러한 사항들도 고려할 수 있어야 함